// Generated by CoffeeScript 1.6.3
(function() {
  var blankTemplate, fs, handlebars, pathCache, textCache, utils;

  fs = require("fs");

  handlebars = require("handlebars");

  utils = require("../utils");

  pathCache = {};

  textCache = {};

  blankTemplate = handlebars.compile("");

  module.exports = {
    fromPath: function(path, callback) {
      var t;
      if (t = pathCache[path]) {
        callback(t);
        return;
      }
      return fs.readFile(path, function(err, data) {
        if (err) {
          console.error("open file " + path + " error", err);
          return callback(blankTemplate);
        } else {
          pathCache[path] = t = handlebars.compile(data.toString());
          return callback(t);
        }
      });
    },
    fromPathSync: function(path) {
      var t;
      if (t = pathCache[path]) {
        return t;
      }
      pathCache[path] = t = handlebars.compile(fs.readFileSync(path).toString());
      return t;
    },
    fromText: function(text) {
      var md5, t;
      md5 = utils.md5(text);
      if (t = textCache[md5]) {
        return t;
      }
      textCache[md5] = t = handlebars.compile(text);
      return t;
    }
  };

}).call(this);
