// Generated by CoffeeScript 1.6.3
(function() {
  var compData, dataFilePath, env, fs, loadData, path, urlData, watch, _;

  fs = require("fs");

  path = require("path");

  watch = require("node-watch");

  env = require("./enviroments");

  _ = require("lodash");

  dataFilePath = env.dataFile;

  urlData = {};

  compData = {};

  loadData = function() {
    var data;
    if (fs.existsSync(dataFilePath)) {
      data = require(dataFilePath);
      urlData = data.urls || {};
      return compData = data.comps || {};
    }
  };

  loadData();

  watch(dataFilePath, function() {
    var err;
    require.cache[dataFilePath] = null;
    try {
      loadData();
      return console.log("[Data Reload]");
    } catch (_error) {
      err = _error;
      return console.log("[Data Reload Error] " + err);
    }
  });

  module.exports = {
    getUrlData: function(path, method, params) {
      var data;
      if (!_.has(urlData, path)) {
        return {
          found: false
        };
      }
      data = urlData[path];
      return {
        found: true,
        result: _.isFunction(data) ? data(params, method) : data
      };
    },
    getCompData: function(path, params) {
      var data;
      if (!_.has(compData, path)) {
        return {
          found: false
        };
      }
      data = compData[path];
      return {
        found: true,
        result: _.isFunction(data) ? data(params) : data
      };
    }
  };

}).call(this);
